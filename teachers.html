<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Data Guru</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 p-6">

<h1 class="text-2xl font-bold mb-4">Guru</h1>

<table class="w-full bg-white rounded-xl shadow text-sm">
<thead class="bg-slate-200">
<tr>
  <th class="p-3">NIP</th>
  <th class="p-3">Nama</th>
  <th class="p-3">Mapel</th>
  <th class="p-3">Kelas</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
Promise.all([
  fetch('./data/teachers.json').then(r=>r.json()),
  fetch('./data/lesson_schedule.json').then(r=>r.json()),
  fetch('./data/lessons.json').then(r=>r.json()),
  fetch('./data/classes.json').then(r=>r.json())
]).then(([teachers, schedules, lessons, classes]) => {

  const lById = Object.fromEntries(lessons.map(l=>[l.id,l]));
  const cById = Object.fromEntries(classes.map(c=>[c.id,c]));
  const tbody = document.getElementById('tbody');

  teachers.forEach(t => {
    const rows = schedules.filter(s => s.teacher_id === t.id);

    rows.forEach(s => {
      tbody.innerHTML += `
        <tr class="border-t">
          <td class="p-3">${t.nip}</td>
          <td class="p-3">${t.name}</td>
          <td class="p-3">${lById[s.lessons_id]?.subject}</td>
          <td class="p-3">${cById[s.class_id]?.name}</td>
        </tr>`;
    });
  });
});
</script>

</body>
</html>
